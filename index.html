<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#1f2430"/>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" sizes="192x192" href="icon-192.png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <title>Logos</title>
  <style>
    :root {
      --bg:#141820; --panel:#1f2430; --tile:#2a2e38; --tile-border:#3a3f4d;
      --text:#eaeef7; --muted:#8e97a8; --green:#6aaa64; --yellow:#c9b458; --gray:#3a3a3c;
      --accent:#6aa0ff;
    }
    * { box-sizing: border-box; }
    html, body { height:100%; }
    body {
      margin:0; background:var(--bg); color:var(--text); font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      display:flex; align-items:center; justify-content:center; padding:16px;
    }
    .app { width: min(520px, 100%); }
    header {
      display:flex; align-items:center; justify-content:space-between;
      padding:8px 4px 12px; border-bottom:1px solid #242938; margin-bottom:12px;
    }
    .header-buttons { display:flex; flex-direction:column; gap:8px; align-items:flex-end; }
    .header-row { display:flex; gap:8px; }
    h1 { margin:0; font-size:22px; letter-spacing:3px; text-transform:uppercase; }
    button.icon { background:transparent; border:1px solid #2b3040; color:var(--text); border-radius:10px; padding:6px 10px; cursor:pointer; }
    .board { display:grid; grid-template-rows: repeat(6, 1fr); gap:8px; padding:8px; }
    .row { display:grid; grid-template-columns: repeat(5, 1fr); gap:8px; }
    .tile {
      height:58px; display:flex; align-items:center; justify-content:center;
      font-weight:700; font-size:24px; text-transform:uppercase;
      border-radius:10px; background:var(--tile); border:1px solid var(--tile-border);
      transition: transform .07s ease, background .2s;
    }
    .tile.reveal { transform: scale(1.02); }
    .kbs { display:flex; flex-direction:column; gap:8px; padding:8px; align-items:center; }
    .kb-row { display:flex; gap:6px; justify-content:center; }
    .key {
      background:#2c3140; color:var(--text); border:none; padding:12px 10px;
      border-radius:10px; font-weight:600; cursor:pointer; min-width:30px;
      text-transform:uppercase;
    }
    .key.wide { min-width:64px; font-size:14px; }
    .k-green { background: var(--green) !important; }
    .k-yellow { background: var(--yellow) !important; color:#111 !important; }
    .k-gray { background: var(--gray) !important; }
    .status { text-align:center; color:var(--muted); padding:4px 0 8px; min-height:20px; }
    .footer { display:flex; gap:10px; justify-content:space-between; align-items:center; padding:8px; color:var(--muted); font-size:12px; }
    .stats { display:flex; gap:12px; align-items:center; }
    .stat { background:#1d2230; border:1px solid #2a2f3d; padding:8px 10px; border-radius:10px; }
    .toast {
      position:fixed; top:16px; left:50%; transform:translateX(-50%);
      background:#1d2230; border:1px solid #2a2f3d; padding:10px 14px; border-radius:10px; color:var(--text);
      opacity:0; pointer-events:none; transition:opacity .25s;
    }
    .toast.show { opacity:1; }
    a { color:var(--accent); text-decoration:none; }

    .modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:flex; align-items:center; justify-content:center; }
    .modal.hidden { display:none; }
    .modal-box { background:var(--panel); padding:20px; border-radius:10px; text-align:center; max-width:300px; }
    .modal-box button { margin-top:10px; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>LOGOS</h1>
      <div class="header-buttons">
        <div class="header-row">
          <button class="icon" id="btn-new">Daily Word</button>
          <button class="icon" id="btn-free">Free Play</button>
          <button class="icon" id="btn-hint">Hint</button>
        </div>
        <div class="header-row">
          <button class="icon" id="btn-share">Share</button>
          <button class="icon" id="btn-update">Update</button>
          <button class="icon" id="btn-install" style="display:none;">Install</button>
        </div>
      </div>
    </header>

    <div class="status" id="status"></div>

    <div class="board" id="board"></div>

    <div class="kbs" id="kbs"></div>

    <div class="footer">
      <div class="stats">
        <div class="stat"><span id="s-played">0</span> played</div>
        <div class="stat"><span id="s-win">0</span>% win</div>
        <div class="stat">streak <span id="s-streak">0</span></div>
      </div>
      <div><a href="https://www.biblegateway.com/passage/?search=John%203%3A16&version=NIV" style="text-decoration: none; color: white;" target="_blank">Jesus Saves</a></div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <div class="modal hidden" id="intro-modal">
    <div class="modal-box">
      <h2>Welcome to Logos</h2>
      <p>Guess the word in 6 tries. A new word appears every day. You may use one hint per game.</p>
      <button id="intro-start">Start</button>
    </div>
  </div>

  <div class="modal hidden" id="win-modal">
    <div class="modal-box">
      <h2>Congratulations!</h2>
      <p>You solved the word. Share with friends!</p>
      <button id="win-share">Share</button>
      <button id="win-close">Close</button>
    </div>
  </div>

  <div class="modal hidden" id="lose-modal">
    <div class="modal-box">
      <h2>Game Over</h2>
      <p>The word was <span id="lose-word"></span>.</p>
      <button id="lose-share">Share</button>
      <button id="lose-close">Close</button>
    </div>
  </div>

  <div class="modal hidden" id="free-modal">
    <div class="modal-box">
      <h2>Free Play</h2>
      <p>Words are picked at random. Free Play sharpens your Logos skills. You may use one hint per game.</p>
      <button id="free-start">Start</button>
      <button id="free-cancel">Cancel</button>
    </div>
  </div>

  <div class="modal hidden" id="free-result-modal">
    <div class="modal-box">
      <h2 id="free-result-title"></h2>
      <p id="free-result-text"></p>
      <button id="free-again-yes">Yes</button>
      <button id="free-again-no">No</button>
    </div>
  </div>

  <script>
    // --- PWA install prompt handling ---
    let deferredPrompt = null;
    let swReg;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('btn-install').style.display = 'inline-block';
    });
    document.getElementById('btn-install').addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
      document.getElementById('btn-install').style.display = 'none';
    });

    // --- Service Worker ---
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').then(reg => {
        swReg = reg;
      });
      navigator.serviceWorker.addEventListener('controllerchange', () => location.reload());
    }

    document.getElementById('btn-update').addEventListener('click', async () => {
      if (!swReg) return;
      await swReg.update();
      if (swReg.waiting) {
        if (confirm('Update available. Reload now?')) {
          swReg.waiting.postMessage({type:'SKIP_WAITING'});
        }
      } else {
        toastMsg('Already up to date');
      }
    });

    // --- Game State ---
    const ANSWERS = [
"wheat","cleat","aisle","grill","torch","mirth","trail","found","thong","order","fluke","jerky","ionic","sport","dread","howdy","motor","bryon","woken","feral",
"recto","ethyl","lobby","altar","smell","orbit","shewn","house","cubit","quilt","quiet","perch","retro","score","pried","blunt","belay","tenth","phone","radii",
"twain","smile","needy","crime","odder","booth","cline","terra","canal","waver","vocal","tinge","raven","fecal","helot","rearm","steed","block","grave","raspy",
"gains","among","grown","crank","china","calix","staid","glory","macro","snark","lover","stick","under","deign","yearn","etude","drape","umbra","enact","mercy",
"tweet","pause","icily","tuple","homer","rhino","regal","sniff","queer","faith","ruler","liner","kiosk","breed","trash","bluff","bribe","snafu","trout","stone",
"ozone","kudos","skill","vendr","glove","knock","riley","savor","uncle","femur","field","agile","modus","bogus","lorry","clamp","ember","peace","attar","porch",
"doses","guile","flute","crisp","folly","calyx","blurt","bloat","dully","tunic","shaft","shown","known","clink","bench","goopy","scuff","gypsy","ketch","brook",
"later","rapid","burnt","grump","brunt","laser","ultra","chili","skimp","lingo","river","germs","rival","cairn","clump","sully","feast","prune","booth","sepia",
"halve","caste","hymns","sepal","gaffe","dandy","sworn","crate","lanky","briar","thrum","story","rivet","stove","lavvy","idyll","geeky","elfin","toast","bloke",
"helms","exact","snide","voice","cacti","movie","daisy","optic","noose","sheet","grist","goads","dairy","broom","slain","grand","brisk","skirt","lousy","largo",
"scowl","burly","ardor","mulch","chair","slurp","fiend","lowly","usage","dense","retry","beset","evert","ditto","along","taper","beast","crone","shelf","roman",
"genus","pecan","serve","ditch","psalm","threw","glade","tapir","cloak","zonal","motif","alone","noble","ulnae","arise","sitar","worry","aspic","slide","cargo",
"might","pylon","hotel","erode","bugle","undid","tried","image","thigh","chime","guess","scary","aroma","sling","sugar","shave","rover","foyer","forty","pushy",
"totem","paper","wrong","fresh","pound","begin","marry","itchy","pizza","sloop","cacao","honor","apron","droop","sheer","nimbi","avert","nifty","dicot","laure",
"stair","fryer","sumac","growl","manga","assay","ounce","birch","enter","lapel","aside","madly","oaten","banal","shell","forte","shyly","trick","tonga","stung",
"yummy","watch","ducal","tough","quest","taunt","slash","ombre","tiger","agora","tread","world","meter","staff","jolly","bland","perry","skunk","loamy","ingot",
"undue","noisy","utter","quail","imply","smock","slate","asset","agape","drier","dried","shine","stunt","ebony","scion","scree","cough","conga","issue","radar",
"vicar","jingo","firth","sigma","eager","dealt","prude","scare","water","verve","hitch","petri","alias","drake","prior","octet","trice","spear","tweed","ovate",
"snarl","loser","patch","plied","sleek","coils","piggy","nexus","bused","medal","since","dimen","dying","frisk","exist","cocoa","towel","musky","clown","chaff",
"icier","cocci","civil","limbo","waxen","study","facet","swing","globe","pitch","login","decay","inner","latex","upper","speak","adroit","desks","plonk","drums",
"nitro","biome","ocean","civic","doubt","favor","swill","titan","haunt","visas","dowel","hardy","burst","dural","extol","sabre","lilac","dingy","until","untie",
"terse","drawn","often","eject","start","weave","sight","duets","apple","ripen","silly","brief","freed","saute","oomph","finis","posse","shall","beady","basil",
"havoc","duped","geode","pride","gleam","wordy","alley","flume","cater","soapy","twelve","quill","creme","affix","belle","class","blame","today","refit","antic",
"reply","afire","endue","stale","craze","tardy","never","mango","limen","bingo","showy","payee","comma","papal","plume","cohere","beach","gears","viral","avian",
"fling","adapt","suing","hovel","redeem","lager","store","barge","canny","album","edict","gawky","corgi","disco","madam","stare","truss","diety","spire","tilth",
"hertz","zesty","waxer","noise","qualm","clued","erupt","jumpy","labor","urged","otter","handy","sited","glean","sonic","layer","cycle","milky","crass","tumor",
"novel","shoal","reuse","ficus","train","folks","spiel","dress","thief","cynic","whoop","repel","cavil","strop","month","devon","refer","condo","unfit","flask",
"zebra","tepid","ergot","hover","vague","trace","elect","palmy","parer","smoky","timid","sober","liars","overt","cache","elbow","charm","tonic","valet","cuter",
"berry","metro","busts","logic","stamp","colts","froth","twang","stout","crush","union","bolus","rocky","crave","below","sonar","pesto","budge","aloud","bleed",
"plain","credo","lyric","retch","flick","nanny","onset","place","cliff","teach","worth","nicer","zilch","tally","avion","vardo","ileum","rainy","comma","bruit",
"power","tonal","amble","catch","bialy","renew","plane","posit","wooly","dolor","tacit","scoff","teary","brass","built","odium","crash","hairy","crust","await",
"works","fatty","bezel","bound","pinky","ghost","trope","shade","heist","crest","hoard","genre","smart","poser","poise","prize","croak","plier","sabin","fired",
"cribs","spell","sneer","anode","mould","stoic","ninja","freak","truce","tuber","occur","cardi","ridge","gauge","brick","hider","bunch","carat","crimp","dicey",
"grass","comet","borax","fugue","pooch","quell","finer","attic","smear","exalt","liver","lucky","sooty","wield","unity","taken","munch","treks","aware","cover",
"feint","edify","crook","claim","haste","steep","bushy","glare","bison","blitz","chose","board","solve","smote","franc","spike","bunny","sneak","orate","prism",
"brute","trite","mummy","clutch","gassy","hired","shove","bacon","squat","glass","flora","larva","lumen","aline","cobol","query","sound","skies","chard","bluer",
"angst","short","pearl","primo","ureas","chore","shack","stern","stomp","angel","rerun","rower","champ","ovine","whack","tolls","thorn","delve","amity","idler",
"xylem","pseud","shire","rigid","width","nasal","calms","swarm","repot","filmy","caput","amine","apace","blown","sewer","mafic","torte","treat","unwed","rebar",
"briny","gnash","habit","float","queen","binge","visit","lolly","horny","remit","tiler","unlit","ready","quote","elude","peony","egret","utile","great","obese",
"lapse","fetus","oscar","diver","stump","point","grate","grace","newly","maybe","trier","seven","meson","conic","award","cedar","groin","whale","nieve","vulgo",
"quart","wispy","kappa","fifty","myrrh","defer","viola","bayou","plant","tulip","click","weigh","flair","traps","stall","chasm","drove","polar","impel","gaily",
"butte","haven","roily","yucca","phage","aptly","brawn","candy","inert","creep","ensue","atomy","lemur","speed","which","brash","flesh","swoon","snipe","ovary",
"ascot","reach","flank","scoop","stole","flock","snuck","vouch","lunar","brace","vaunt","recut","stork","stirk","lurch","hippo","drool","harem","input","agree",
"broad","torso","flash","unite","witty","vowel","alert","mussy","clair","lower","cobra","strum","leant","broil","fleck","pupil","cozen","blare","arson","amend",
"villa","debut","revel","buddy","argue","swamp","idiot","march","snort","vocab","token","angle","label","octal","frail","unify","berth","tress","vesta","guilt",
"nonce","foxed","aeons","anvil","whelp","moral","force","smack","glide","comfy","olive","three","sperm","verse","harpy","chute","clove","skiff","snowy","black",
"blond","solar","frill","tiled","smash","vasty","magic","femme","botch","throb","enemy","drift","probe","maser","welsh","perks","genie","stahl","exert","lacey",
"proud","blind","usurp","nabob","spill","clang","sweet","squid","laden","brand","talon","polyp","opera","bible","blurb","gavel","onion","crawl","shirk","newer",
"loose","blast","dwell","frame","cadet","tribe","piety","cello","south","shady","jiffy","emend","frank","woosh","snail","cutie","livid","brush","mushy","leach",
"swirl","event","friar","easel","think","weird","ogive","kitty","cloze","spelt","skulk","wooer","curry","gloat","gulch","slice","finger","lasso","ovoid","opals",
"round","scale","entry","gorge","buyer","allot","gaunt","deuce","sushi","junta","bless","strap","groom","forth","dinar","spite","augur","fetch","scent","prose",
"eater","lemon","slink","spout","necro","rural","recon","shrub","unpin","bleak","oiled","shape","gauze","azide","slang","valor","ramen","prate","scrap","crown",
"fable","valid","deism","grief","inlet","crazy","druid","riper","press","slime","purge","canon","crony","visor","erase","hiker","bleat","crier","crews","privy",
"waltz","manse","queue","swish","runic","shale","azure","tawny","comic","lupus","chafe","gummy","chase","gamma","shook","louse","roach","diary","crock","giver",
"phase","mecca","prove","valve","elope","cameo","swift","molar","stony","miser","guise","squib","guava","react","wring","slush","false","storm","stuck","scroll",
"drawl","corky","grind","stark","alder","giddy","fluid","cloud","folio","spasm","mourn","nerve","drone","fuzzy","baili","witch","steal","coder","saber","tinct",
"suave","slyly","groan","sable","finch","xeric","began","wight","feign","pixel","swept","alter","harsh","toxic","tummy","duomo","cyber","robin","whose","those",
"mater","arena","hiver","chalk","droll","demur","piker","could","dally","lithe","matte","kneel","trait","leper","expel","knack","scrip","swoop","mover","trust",
"patri","scrub","spook","tilde","serif","crowd","bobby","basin","scone","aural","aglow","resin","vapid","elder","juicy","humph","flown","ranch","recap","repay",
"bread","toner","tract","curly","vivid","aster","vexer","rally","child","essay","melee","winch","stilt","rebus","slack","exile","scour","gloss","table","swell",
"parka","shrew","taint","clout","taboo","blimp","curio","slosh","rough","blood","loyal","relay","royal","zowie","felon","moldy","rogue","feces","break","grade",
"dusky","thing","bongo","amigo","clank","sixth","array","gland","stoke","grime","local","poesy","apply","steel","bathe","brain","belie","stash","dross","metal",
"mouth","frown","drown","crude","shunt","cabal","yours","rebid","muddy","dunce","sopor","spoon","scorn","gonna","flame","bowel","drill","sprig","decaf","tutor",
"nobly","jelly","vault","bipod","hours","chief","nudge","cagey","greed","price","auric","ideas","skull","ladle","duchy","windy","wreck","flirt","brawl","smelt",
"focus","tower","minor","yodel","cense","ghoul","wacky","guard","agent","mealy","juice","frock","awash","meant","strew","realm","choke","sheen","allow","dizzy",
"skein","nomad","radio","cress","axiom","shift","scamp","wrath","triff","irate","hocus","throw","virtu","crick","moved","crypt","kayak","dozen","weedy","draft",
"smite","stave","strut","ilium","honey","tight","craft","sheaf","whine","covid","hempy","glaze","betel","roost","chess","sweep","depth","tempo","touch","fraud",
"shout","allay","vital","stunk","heavy","lunge","quint","baton","truly","fjord","gamut","state","inter","conic","email","cower","brood","shear","stein","shush",
"rumor","where","lumpy","stint","niche","earth","spurn","rajah","filth","dwind","daily","spawn","birth","rabid","tidal","braid","leafy","agate","yacht","audit",
"scaup","cramp","badge","loved","magma","plate","awoke","lance","veins","kites","manor","sweat","yeast","snore","risky","avail","solid","varda","clash","teeth",
"silky","glint","thick","trump","about","sable","vista","decry","sulky","tithe","meaty","fugal","fairy","amide","nasty","mason","tuned","blade","youth","guild",
"scene","stipe","xenon","kebab","puree","alive","heave","faint","riser","ennui","frond","quash","coker","crane","baler","hunch","extra","linen","neath","petal",
"tinge","ninth","merit","naval","welch","midst","equal","quirk","libel","snack","naiad","quack","hoist","spade","spare","flood","shone","moron","horde","hatch",
"elven","virus","drank","foray","modal","topic","young","fifth","batch","guest","flour","dirty","polka","smoke","covet","spied","major","split","evoke","money",
"yoked","endow","stuff","purse","mange","tense","fibre","level","spark","finch","moist","reman","maize","stead","chive","ledge","mayor","stink","codex","tours",
"nacho","joust","mouse","carom","plush","fancy","crept","diode","share","vomit","frats","lexis","climb","stake","colon","humor","coach","fount","squad","stiff",
"slimy","pesky","human","creek","corps","haiku","eaten","lease","eight","carve","ixora","guide","hazel","spiky","rouse","cumin","beret","ivory","medic","piece",
"graph","nodes","girth","iodic","steer","clear","burse","spicy","clock","ditty","stack","write","spray","chasm","hexed","raise","fever","urine","proxy","slept",
"tramp","curve","offal","apnea","wrist","sieve","fetid","cobalt","swash","flint","reset","doily","spoke","roast","right","ought","plumb","sower","badly","hasty",
"velar","eland","dough","lasts","media","couch","elite","bough","slung","calla","oxide","racer","paint","laird","doped","blink","bagel","wryly","hangs","swath",
"clack","hyena","flout","scold","begun","metre","atlas","clean","coven","gruff","relic","laugh","detox","omits","musty","snake","hound","boule","robot","whirl",
"peers","crack","pivot","towed","mossy","pavan","adobe","worst","maker","abler","awake","forum","stand","syrup","sloth","fetal","stirs","gripe","death","quick",
"route","clasp","doing","music","clung","donor","spine","mural","freer","color","cubic","quota","vigor","wrung","triad","cloth","sleep","ratio","trawl","anger",
"rinse","idiom","dusty","hedge","gamer","lipid","copper","hippy","shrug","minus","igloo","brink","track","swine","rider","gusto","fauna","crepe","croon","pedal",
"spree","holly","hobby","opine","modem","quite","usher","total","sided","vodka","hinge","offer","glyph","basis","vigil","infer","omega","brown","paver","mucus",
"exult","tizzy","naive","carol","spank","droit","cohos","rarer","horse","derby","helix","corse","ethos","fence","bonus","forgo","roost","atoll","lusty","pique",
"lever","eagle","uteri","cluck","knife","women","conch","fault","penal","flung","match","cruel","evict","taffy","woman","gully","gumbo","chain","morph","jubil",
"error","elide","merge","suite","loopy","steam","adage","speck","white","venom","loner","vetch","slick","ideal","spunk","balmy","drink","outgo","inkle","vegan",
"moire","arbor","sleet","humid","penne","chord","title","singe","thump","sword","hello","bring","jumbo","grift","rifle","relax","rouge","slave","bulky","voter",
"zombi","shoot","sixty","chirp","radix","final","melon","gaudy","hydro","hilly","aegis","vogue","larch","using","plait","brave","slump","spice","unmet","askew",
"wrest","sharp","boast","mower","fella","heath","piano","aloof","licit","ethic","fight","tacky","graft","uncut","build","dream","knelt","neigh","model","epoxy",
"nerdy","clerk","icing","woven","setup","alpha","north","geese","style","knead","beard","carbo","jazzy","space","rehab","grasp","stock","tenet","judas","arrow",
"hoofe","pleat","theta","spoof","douse","boils","early","bloom","night","aloft","hooch","spiny","close","organ","wedge","shark","hydra","siren","envoy","cable",
"ashen","islet","cling","biddy","yahoo","bliss","front","plaid","dodge","cried","rosin","clone","begat","tango","rupee","goods","weary","tenor","snoop","hoary",
"truth","savor","deist","hooky","evade","given","demon","abate","boggy","flyer","trove","chant","sting","adept","gable","devil","bulge","alibi","miner","juror",
"delta","lurid","sinew","loath","wrack","sores","brine","nurse","tweak","maple","nadir","seams","scalp","learn","grape","chart","wound","dowry","wreak","velum",
"genom","snare","wiser","foamy","brake","cooks","spent","oakum","karma","cupid","ester","jazzy","bylaw","blank","smirk","embed","broth","drain","canto","artsy",
"giant","spoil","shiny","schwa","greet","tenty","coinx","adieu","chaos","scarf","slope","sheep","snaky","screw","range","aorta","gravy","nutty","sever","units",
"drama","plank","value","verge","bully","stile","eerie","dregs","ulcer","tease","banjo","wrote","oasis","scant","codon","paddy","spurt","straw","irony","toxin",
"trade","vetoe","hokum","photo","widow","mania","vitro","soggy","mound","splat","happy","forge","cushy","inane","grain","colic","pouch","blaze","smith","blush",
"knell","steak","dutch","heady","shame","limit","would","small","cajun","perm","cleft","chide","stain","whisk","revue","ferry","bovid","patio","trend","laity",
"baker","dishy","spend","payer","prawn","adorn","snout","pagan","strip","peril","equip","frost","being","dance","prank","serum","lacks","heron","cream","floor",
"erect","spool","lucid","venue","lotus","poets","still","lunch","plead","abbey","camel","murky","loins","dryer","micro","hurly","blend","focal","elegy","datum",
"boxer","croup","quake","llama","trunk","quaff","outdo","broke","cross","gloom","stage","hurry","enjoy","siege","coyly","tryst","bravo","gnome","rebut","party",
"rayon","print","drive","rooms","shock","fatal","moult","jewel","coral","avoid","scope","widen","mount","pilot","stalk","rigor","vexed","wince","sauce","vixen",
"scout","coast","reify","wheel","graze","algae","mimic","learn","wider","renal","stray","grant","plump","boost","trial","voila","perky","depot","shake","grove",
"flare","hutch","reign","parse","scuba","rusty","stoop","woody","rhyme","elute","crumb","bleep","rotor","venal","amuse","alloy","vapor","poppy","gourd","lofty",
"third","worse","whole","shore","dunno","other","pacer","vinyl","cinch","maths","usual","koala","swami","twixt","hobby","unsay","fiber","green","choir","skate",
"roped","synod","empty","bevel","nears","viper"
];
    const ALPH = "qwertyuiopasdfghjklzxcvbnm";
    const ROWS = 6, COLS = 5;

    const $ = (id) => document.getElementById(id);
    const board = $('board'); const kbs = $('kbs'); const status = $('status');
    const toast = $('toast');

    let freePlay = false;
    let target = pickWord();
    let row = 0, col = 0, over = false;
    let hintUsed = false;
    let grid = Array.from({length: ROWS}, () => Array(COLS).fill(""));
    let meta = Array.from({length: ROWS}, () => Array(COLS).fill(""));
    const stats = loadStats();

    // Build board UI
    function buildBoard() {
      board.innerHTML = "";
      for (let r=0; r<ROWS; r++) {
        const rowEl = document.createElement('div'); rowEl.className = 'row';
        for (let c=0; c<COLS; c++) {
          const t = document.createElement('div'); t.className = 'tile'; t.id = `t-${r}-${c}`;
          rowEl.appendChild(t);
        }
        board.appendChild(rowEl);
      }
    }

    // Keyboard UI
    function buildKeyboard() {
      const rows = ["qwertyuiop","asdfghjkl","⟵zxcvbnm↵"];
      kbs.innerHTML = "";
      for (const r of rows) {
        const d = document.createElement('div'); d.className = 'kb-row';
        for (const ch of r) {
          const b = document.createElement('button');
          b.className = 'key';
          if (ch==='⟵') { b.textContent='⌫'; b.classList.add('wide'); b.onclick = backspace; }
          else if (ch==='↵') { b.textContent='Enter'; b.classList.add('wide'); b.onclick = enter; }
          else { b.textContent = ch; b.onclick = () => add(ch); }
          b.id = `k-${ch}`;
          d.appendChild(b);
        }
        kbs.appendChild(d);
      }
    }

    function pickWord() {
  const start = new Date(new Date().getFullYear(), 0, 0);
  const today = new Date();
  const diff = today - start;
  const day = Math.floor(diff / (1000*60*60*24)); // 1..365
  return ANSWERS[(day - 1) % ANSWERS.length];
}

    function pickRandomWord() {
      return ANSWERS[Math.floor(Math.random()*ANSWERS.length)];
    }

    function draw() {
      for (let r=0; r<ROWS; r++) {
        for (let c=0; c<COLS; c++) {
          const t = $(`t-${r}-${c}`);
          t.textContent = grid[r][c] || "";
          const m = meta[r][c];
          t.style.background = (m==='g' || m==='h') ? 'var(--green)' : m==='y' ? 'var(--yellow)' : m==='x' ? 'var(--gray)' : 'var(--tile)';
          t.style.color = m==='y' ? '#111' : 'var(--text)';
        }
      }
    }

    function add(ch) {
      if (over) return;
      if (col < COLS) { grid[row][col++] = ch; draw(); }
    }
    function backspace() {
      if (over) return;
      if (col>0) { grid[row][--col] = ""; meta[row][col] = ''; draw(); }
    }
    function enter() {
      if (over) return;
      if (col < COLS) { return toastMsg("Not enough letters"); }
      const guess = grid[row].join('');
      if (!isValid(guess)) { return toastMsg("Not in list"); }
      reveal(guess);
    }
    function isValid(w) {
      return w.length===COLS && ANSWERS.includes(w);
    }

    function giveHint() {
      if (over) return;
      if (hintUsed) return toastMsg('Hint already used');
      if (col >= COLS) return toastMsg('No hint available');
      grid[row][col] = target[col];
      meta[row][col] = 'h';
      const k = $('k-'+target[col]);
      if (k) { k.classList.remove('k-yellow','k-gray'); k.classList.add('k-green'); }
      col++;
      draw();
      hintUsed = true;
      $('btn-hint').disabled = true;
    }

    function reveal(guess) {
      const tgt = target;
      const counts = {};
      for (const ch of tgt) counts[ch]=(counts[ch]||0)+1;

      // First pass: greens
      for (let c=0; c<COLS; c++) {
        if (guess[c]===tgt[c]) { meta[row][c]='g'; counts[guess[c]]--; }
      }
      // Second pass: yellows / grays
      for (let c=0; c<COLS; c++) {
        if (meta[row][c]) continue;
        const ch = guess[c];
        if (tgt.includes(ch) && counts[ch]>0) { meta[row][c]='y'; counts[ch]--; }
        else meta[row][c]='x';
      }

      // Update keyboard colors (priority g>y>x)
      for (let c=0; c<COLS; c++) {
        const ch = guess[c];
        const k = $('k-'+ch);
        if (!k) continue;
        if (meta[row][c]==='g') { k.classList.remove('k-yellow','k-gray'); k.classList.add('k-green'); }
        else if (meta[row][c]==='y' && !k.classList.contains('k-green')) { k.classList.add('k-yellow'); }
        else if (!k.classList.contains('k-green') && !k.classList.contains('k-yellow')) k.classList.add('k-gray');
      }

      draw();
      if (guess===tgt) { endGame(true); return; }
      row++; col=0;
      if (row===ROWS) endGame(false);
    }

    function endGame(win) {
      over = true;
      if (win) {
        toastMsg("Nice! You got it.");
        incrementStats(true, row);
        if (freePlay) {
          $('free-result-title').textContent = 'Congratulations!';
          $('free-result-text').textContent = 'Play again?';
          $('free-result-modal').classList.remove('hidden');
        } else {
          $('win-modal').classList.remove('hidden');
        }
      }
      else {
        toastMsg("The word was '"+target+"'");
        incrementStats(false, ROWS);
        if (freePlay) {
          $('free-result-title').textContent = "The word was '"+target+"'";
          $('free-result-text').textContent = 'Play again?';
          $('free-result-modal').classList.remove('hidden');
        } else {
          $('lose-word').textContent = target;
          $('lose-modal').classList.remove('hidden');
        }
      }
      updateStatsUI();
    }

    function toastMsg(msg) {
      toast.textContent = msg; toast.classList.add('show');
      clearTimeout(window._t);
      window._t = setTimeout(()=>toast.classList.remove('show'), 1600);
    }

    // Stats
    function loadStats() {
      const d = JSON.parse(localStorage.getItem('wi-stats')||'{}');
      return { played:d.played||0, wins:d.wins||0, streak:d.streak||0, maxStreak:d.maxStreak||0, dist:d.dist||[0,0,0,0,0,0] };
    }
    function saveStats() { localStorage.setItem('wi-stats', JSON.stringify(stats)); }
    function incrementStats(win, tries) {
      stats.played++; if (win) { stats.wins++; stats.streak++; stats.maxStreak=Math.max(stats.maxStreak, stats.streak); stats.dist[tries-1]++; }
      else stats.streak=0;
      saveStats();
    }
    function updateStatsUI() {
      $('s-played').textContent = stats.played;
      $('s-win').textContent = stats.played ? Math.round(100*stats.wins/stats.played) : 0;
      $('s-streak').textContent = stats.streak;
    }

    // Share
    function buildShare() {
      let usedRows = over && grid[row]?.every(x=>x) ? row+1 : row;
      usedRows = Math.min(usedRows, ROWS);
      const lines = [];
      for (let r=0; r<usedRows; r++) {
        let line = "";
        for (let c=0; c<COLS; c++) {
          line += meta[r][c]==='g' ? '🟩' : meta[r][c]==='y' ? '🟨' : '⬛';
        }
        lines.push(line);
      }
      return "No ads, no registration, just Logos. Play at https://tinyurl.com/LogosGame\n" + lines.join('\n');
    }

    async function doShare() {
      const text = buildShare();
      try {
        if (navigator.share) {
          await navigator.share({ text });
        } else {
          await navigator.clipboard.writeText(text);
          toastMsg("Result copied");
        }
      } catch(e) {
        toastMsg("Share failed");
      }
    }

    $('btn-share').addEventListener('click', doShare);
    $('btn-hint').addEventListener('click', giveHint);
    $('btn-new').addEventListener('click', () => newGame());
    $('btn-free').addEventListener('click', () => $('free-modal').classList.remove('hidden'));
    $('free-start').addEventListener('click', () => { freePlay = true; $('free-modal').classList.add('hidden'); newGame(); });
    $('free-cancel').addEventListener('click', () => $('free-modal').classList.add('hidden'));
    $('free-again-yes').addEventListener('click', () => { $('free-result-modal').classList.add('hidden'); newGame(); });
    $('free-again-no').addEventListener('click', () => { $('free-result-modal').classList.add('hidden'); freePlay=false; });
    $('intro-start').addEventListener('click', () => $('intro-modal').classList.add('hidden'));
    $('win-close').addEventListener('click', () => $('win-modal').classList.add('hidden'));
    $('win-share').addEventListener('click', doShare);
    $('lose-close').addEventListener('click', () => $('lose-modal').classList.add('hidden'));
    $('lose-share').addEventListener('click', doShare);

    function newGame() {
      target = freePlay ? pickRandomWord() : pickWord(); row=0; col=0; over=false; hintUsed=false;
      grid = Array.from({length: ROWS}, () => Array(COLS).fill(""));
      meta = Array.from({length: ROWS}, () => Array(COLS).fill(""));
      // reset keyboard color classes
      for (const ch of ALPH) {
        const k=$('k-'+ch); if (k) k.classList.remove('k-green','k-yellow','k-gray');
      }
      status.textContent = "";
      $('btn-hint').disabled = false;
      draw();
    }

    // Physical keyboard
    window.addEventListener('keydown', (e)=> {
      if (e.key==='Enter') enter();
      else if (e.key==='Backspace') backspace();
      else {
        const ch = e.key.toLowerCase();
        if (ALPH.includes(ch)) add(ch);
      }
    });

    // Initialize
    buildBoard(); buildKeyboard(); draw(); updateStatsUI();
    $('intro-modal').classList.remove('hidden');

  </script>
</body>
</html>
